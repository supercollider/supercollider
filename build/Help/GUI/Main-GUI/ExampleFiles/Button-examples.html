<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<title></title>
<meta name="Generator" content="Cocoa HTML Writer">
<meta name="CocoaVersion" content="949.43">
<style type="text/css">
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Helvetica}
p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
p.p4 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 9.0px Monaco; min-height: 12.0px}
p.p5 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 12.0px Helvetica}
p.p6 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p7 {margin: 0.0px 0.0px 0.0px 85.0px; text-indent: -85.0px; font: 12.0px Helvetica}
p.p8 {margin: 0.0px 0.0px 0.0px 85.0px; text-indent: -85.0px; font: 12.0px Helvetica; min-height: 14.0px}
p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco}
p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #606060}
p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000; min-height: 12.0px}
p.p12 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #000000}
p.p13 {margin: 0.0px 0.0px 0.0px 57.0px; text-indent: -57.0px; font: 14.0px Helvetica}
p.p14 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #bf0000}
p.p15 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; color: #0000bf}
p.p16 {margin: 0.0px 0.0px 0.0px 0.0px; font: 9.0px Monaco; min-height: 12.0px}
span.s1 {font: 9.0px Monaco}
span.s2 {color: #6f7178}
span.s3 {color: #000000}
span.s4 {color: #0000bf}
span.s5 {color: #606060}
span.s6 {color: #bf0000}
span.s7 {color: #007300}
span.s8 {text-decoration: underline}
span.Apple-tab-span {white-space:pre}
</style>
</head>
<body>
<p class="p1"><b>Some Important Issues Regarding Button</b></p>
<p class="p2"><br></p>
<p class="p3">Failure to set any <b>states</b> at all results in an invisible button.</p>
<p class="p2"><br></p>
<p class="p3">The button performs its action upon releasing the mouse. In musical contexts, you might want to use <span class="s1">mouseDownAction_() </span>to set a function to be performed on pressing the mouse (see <a href="../../Cocoa-GUI/SCView.html"><span class="s2">View</span></a>, and examples below).</p>
<p class="p2"><br></p>
<p class="p3">If the drag contains a number, then <b>valueAction_()</b> is performed using the <b>currentDrag</b>. If the drag contains anything else, <b>action </b>ist set to the current drag. You could, for example, drag a function to an Button, and action would then be set to that function.</p>
<p class="p2"><br></p>
<p class="p1"><b>Creation / Class Methods</b></p>
<p class="p4"><br></p>
<p class="p5"><b><span class="Apple-tab-span">	</span>*new (parent, bounds)</b></p>
<p class="p6"><b><span class="Apple-tab-span">	</span></b></p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>parent </b>- The parent view.</p>
<p class="p7"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><b>bounds </b>- An instance of <a href="../../../Geometry/Rect.html"><span class="s2">Rect</span></a>, or a <a href="../../../Geometry/Point.html"><span class="s2">Point</span></a> indicating width@height.</p>
<p class="p8"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p9"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>(</p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>w = </span><span class="s4">Window</span><span class="s3">.new(</span>"The Four Noble Truths"<span class="s3">);</span></p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>b = <span class="s4">Button</span>(w, <span class="s4">Rect</span>(20,20,340,30))</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.states_([</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[<span class="s5">"there is suffering"</span>, <span class="s4">Color</span>.black, <span class="s4">Color</span>.red],</p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[</span>"the origin of suffering"<span class="s3">, </span><span class="s4">Color</span><span class="s3">.white, </span><span class="s4">Color</span><span class="s3">.black],</span></p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[</span>"the cessation of suffering"<span class="s3">, </span><span class="s4">Color</span><span class="s3">.red, </span><span class="s4">Color</span><span class="s3">.white],</span></p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[</span>"there is a path to cessation of suffering"<span class="s3">, </span><span class="s4">Color</span><span class="s3">.blue, </span><span class="s4">Color</span><span class="s3">.clear]</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>])</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.action_({ <span class="s4">arg</span> butt;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>butt.value.postln;<span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s3">)</span></p>
<p class="p13"><b>Examples</b></p>
<p class="p11"><br></p>
<p class="p12">(</p>
<p class="p12">w = <span class="s4">Window</span>.new(<span class="s5">"Example"</span>);</p>
<p class="p11"><br></p>
<p class="p12">b = <span class="s4">Button</span>(w, <span class="s4">Rect</span>(90,20,200,30))</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.states_([</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[<span class="s5">"sine"</span>, <span class="s4">Color</span>.black, <span class="s4">Color</span>.rand],</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[<span class="s5">"saw"</span>, <span class="s4">Color</span>.black, <span class="s4">Color</span>.rand],</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[<span class="s5">"noise"</span>, <span class="s4">Color</span>.black, <span class="s4">Color</span>.rand],</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[<span class="s5">"pulse"</span>, <span class="s4">Color</span>.black, <span class="s4">Color</span>.rand]</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>])</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.action_({ <span class="s4">arg</span> butt;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>butt.value.postln;<span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p12">w.front;</p>
<p class="p12">)</p>
<p class="p11"><br></p>
<p class="p14">// does not do action</p>
<p class="p12">b.value = 2;</p>
<p class="p11"><br></p>
<p class="p14">// does action if it results in a change of value</p>
<p class="p12">b.valueAction = 3;</p>
<p class="p11"><br></p>
<p class="p14">// clips to size of states</p>
<p class="p12">b.valueAction = -1;</p>
<p class="p11"><br></p>
<p class="p14">// floats no problem</p>
<p class="p12">b.valueAction = 3.3;</p>
<p class="p11"><br></p>
<p class="p11"><br></p>
<p class="p14">//In a musical context, a button-down press is more meaningful than a button-up (release) as it's more</p>
<p class="p14">//intuitive to press a button on the beat. For that you can use View's mouseDownAction</p>
<p class="p14">//(a superclass of Button)</p>
<p class="p11"><br></p>
<p class="p12">(</p>
<p class="p12">s.waitForBoot({</p>
<p class="p12"><span class="Apple-tab-span">	</span>w = <span class="s4">Window</span>.new;</p>
<p class="p12"><span class="Apple-tab-span">	</span>b = <span class="s4">Button</span>(w, <span class="s4">Rect</span>(20,20,80,26))</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.states_([[<span class="s5">"play"</span>, <span class="s4">Color</span>.black, <span class="s4">Color</span>.rand]])</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.mouseDownAction_({</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a = <span class="Apple-tab-span">	</span>{<span class="s4">EnvGen</span>.kr(<span class="s4">Env</span>.adsr,doneAction:2)*<span class="s4">SinOsc</span>.ar(440,0,0.4)}.play;<span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>})</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.action_({ <span class="s4">arg</span> butt, mod;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>a.release(0.3);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p12"><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p12">})</p>
<p class="p12">)</p>
<p class="p11"><br></p>
<p class="p11"><br></p>
<p class="p14">// if you drag a function to a button, the the button's action is set to that function.</p>
<p class="p14">// you can us this for swapping functions.</p>
<p class="p12">(</p>
<p class="p11"><br></p>
<p class="p12">s.waitForBoot({</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="s4">var</span> w,p,snd,b;</p>
<p class="p11"><span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span>w = <span class="s4">Window</span>.new;</p>
<p class="p11"><span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span>b=<span class="s4">Button</span>(w, <span class="s4">Rect</span>(20,20,80,26))</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.states_([[<span class="s5">"start a sound"</span>, <span class="s4">Color</span>.black, <span class="s4">Color</span>.green],[<span class="s5">"stop"</span>, <span class="s4">Color</span>.black, <span class="s4">Color</span>.red]])</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.action_({});</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span>v=</span><span class="s4">VLayoutView</span><span class="s3">(w,</span><span class="s4">Rect</span><span class="s3">(140,20,200,300)); </span>//Group the following views</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="s4">StaticText</span>(v, <span class="s4">Rect</span>(20,20,180,60))</p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.string_(</span>"The button does nothing at first, so try dragging a function to the button"<span class="s3">);</span></p>
<p class="p11"><span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="s4">DragSource</span>(v, <span class="s4">Rect</span>(20,20,80,26))</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.object_(</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>{<span class="s4">|b|</span> (b.value==1).if{snd={ <span class="s4">SinOsc</span>.ar(440,0,0.6) }.play}{snd.free};}<span class="s6">//a button action function</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>)</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.string_(<span class="s5">"a play sine function"</span>).align_(<span class="s7">\center</span>).background_(<span class="s4">Color</span>.rand);</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="s4">DragSource</span>(v, <span class="s4">Rect</span>(20,20,80,26))</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.object_(</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>{<span class="s4">|b|</span> (b.value==1).if{snd={ <span class="s4">Saw</span>.ar(440,0.4) }.play}{snd.free};} <span class="s6">//a button action function</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>)</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.string_(<span class="s5">"a play saw function"</span>).align_(<span class="s7">\center</span>).background_(<span class="s4">Color</span>.rand);</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="s4">DragSource</span>(v, <span class="s4">Rect</span>(20,20,80,26))</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.object_(</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>{<span class="s4">|b|</span> (b.value==1).if{snd={ <span class="s4">WhiteNoise</span>.ar(0.4) }.play}{snd.free};} <span class="s6">//a button action function</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>)</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>.string_(<span class="s5">"a play noise function"</span>).align_(<span class="s7">\center</span>).background_(<span class="s4">Color</span>.rand);</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span>p=</span><span class="s4">CmdPeriod</span><span class="s3">.add({b.value_(0)});</span>// set button to 0 on hitting Cmd-period</p>
<p class="p12"><span class="Apple-tab-span">	</span>w.onClose_{ snd.free; <span class="s4">CmdPeriod</span>.removeAll };<span class="s6">//clean up when window is closed</span></p>
<p class="p12"><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p11"><br></p>
<p class="p12">})</p>
<p class="p12">)</p>
<p class="p11"><br></p>
<p class="p14">// Using <a href="../../../Core/Kernel/Routine.html"><span class="s8">Routine</span></a> to set button states on the fly.</p>
<p class="p12">(</p>
<p class="p12"><span class="s4">var</span> update, w, b;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>w = <span class="s4">Window</span>.new(<span class="s5">"State Window"</span>, <span class="s4">Rect</span>(150,<span class="s4">Window</span>.screenBounds.height-140,380,60));</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// a convenient way to set the button label</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>update = {</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">|but, string|</span> but.states = [[string.asString, <span class="s4">Color</span>.black, <span class="s4">Color</span>.red]];</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>but.refresh;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>b = <span class="s4">Button</span>(w, <span class="s4">Rect</span>(10,10,360,40));</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>b.font_(<span class="s4">Font</span>(<span class="s5">"Impact"</span>, 24));</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>update.value(b, </span>"there is only one state"<span class="s3">);</span></p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// if an action should do something different each time it is called, a routine is the</p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// right thing to use. This is better than creating variables outside and setting them</p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// from the action function to keep state from one action to the next</p>
<p class="p11"><br></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>b.action_(<span class="s4">Routine</span> { <span class="s4">|butt|</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>rrand(15, 45).do { <span class="s4">|i|</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>update.value(butt, <span class="s5">"%. there is still only 1 state"</span>.format(i + 2));</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.yield; <span class="s6">// stop here</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>w.close;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p11"><br></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p12">)</p>
<p class="p11"><br></p>
<p class="p14">// Using <a href="../../../Core/Kernel/Routine.html"><span class="s8">Routine</span></a> to set button states on the fly 2.</p>
<p class="p12">(</p>
<p class="p12">s.waitForBoot({</p>
<p class="p12"><span class="s4">var</span> update, w, b;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>w = <span class="s4">Window</span>.new(<span class="s5">"State Window"</span>, <span class="s4">Rect</span>(150,<span class="s4">Window</span>.screenBounds.height-140,380,60));</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// a convenient way to set the button label</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>update = { <span class="s4">|but, string|</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>but.states = [[string.asString, <span class="s4">Color</span>.black, <span class="s4">Color</span>.red]]; but.refresh };</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>b = <span class="s4">Button</span>(w, <span class="s4">Rect</span>(10,10,360,40));</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>b.font_(<span class="s4">Font</span>(<span class="s5">"Impact"</span>, 24));</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p10"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>update.value(b, </span>"there is only one state"<span class="s3">);</span></p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// if an action should do something different each time it is called, a routine is the</p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// right thing to use. This is better than creating variables outside and setting them</p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// from the action function to keep state from one action to the next</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>b.action_(<span class="s4">Routine</span> { <span class="s4">|butt|</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">var</span> synth, guessVal;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>update.value(butt, <span class="s5">"there are only two states"</span>);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.yield; <span class="s6">// stop here</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>update.value(butt, <span class="s5">"click me"</span>);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.yield; <span class="s6">// stop here</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>update.value(butt, <span class="s5">"click me again"</span>);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.yield; <span class="s6">// stop here ..</span></p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// create a synth</p>
<p class="p15"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>synth = { </span>|freq=1000, rate=5|</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">Ringz</span>.ar(</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">Impulse</span>.ar(rate.lag(4) * [1,1.01]), freq, rrand(0.01, 0.1),0.3</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>)</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}.play;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.yield;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>guessVal = exprand(200.0, 18000).round;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>synth.set(<span class="s7">\freq</span>, guessVal); <span class="s6">// set the synth</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>update.value(butt, <span class="s5">"?"</span>);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.yield;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>update.value(butt, guessVal.asString + <span class="s5">"Hz"</span>); <span class="s6">// display frequency</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>0.yield;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>synth.set(<span class="s7">\rate</span>, rrand(10, 50)); <span class="s6">// set trigger rate</span></p>
<p class="p14"><span class="s3"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></span>// start an independent process</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>fork({ 5.wait; synth.release; update.value(butt, <span class="s5">"."</span>); 1.wait; w.close }, <span class="s4">AppClock</span>);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>});</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">CmdPeriod</span>.doOnce({w.close});</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>w.front;</p>
<p class="p12">});</p>
<p class="p12">)</p>
<p class="p11"><br></p>
<p class="p11"><br></p>
<p class="p14">// complex drag and drop example</p>
<p class="p14">// try dragging the buttons to white slot, adn then between white slots, or simply out fo the view</p>
<p class="p11"><br></p>
<p class="p12">(</p>
<p class="p12"><span class="s4">var</span> w, f, slots;</p>
<p class="p12"><span class="s4">var</span> insert, remove;</p>
<p class="p11"><br></p>
<p class="p12">slots = <span class="s4">Dictionary</span>.new;</p>
<p class="p11"><br></p>
<p class="p12">remove = {<span class="s4">arg</span> slot, id;</p>
<p class="p12"><span class="Apple-tab-span">	</span>[slot, id].postln;</p>
<p class="p12">};</p>
<p class="p11"><br></p>
<p class="p12">insert = {<span class="s4">arg</span> slot, fx;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if(fx!=<span class="s5">""</span>){</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>slots[<span class="s5">"slot"</span>++slot].value_(0).states_([[fx, <span class="s4">Color</span>.white, <span class="s4">Color</span>.blue]]);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>[slot, fx].postln;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>}{</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>slots[<span class="s5">"slot"</span>++slot].value_(0).states_([[ <span class="s5">""</span>, <span class="s4">Color</span>.white, <span class="s4">Color</span>.white ]]);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>remove.value(slot, fx);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p12">};</p>
<p class="p11"><br></p>
<p class="p12">w = <span class="s4">Window</span>.new(<span class="s5">""</span>,<span class="s4">Rect</span>(200, 400, 448, 180));</p>
<p class="p12">w.view.decorator = f = <span class="s4">FlowLayout</span>(w.view.bounds);</p>
<p class="p11"><br></p>
<p class="p10"><span class="s4">StaticText</span><span class="s3">(w, 400@20).string_(</span>"Drag &amp; Drop holding down Cmd-key"<span class="s3">);</span></p>
<p class="p12">f.nextLine;</p>
<p class="p12">6.do{<span class="s4">arg</span> i;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="s4">var</span> fxwin, winOpen=<span class="s4">false</span>, empty = [ <span class="s5">""</span>, <span class="s4">Color</span>.white, <span class="s4">Color</span>.white ];</p>
<p class="p11"><span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span>slots[<span class="s5">"slot"</span>++i] = <span class="s4">Button</span>.new(w, 70@70)</p>
<p class="p12"><span class="Apple-tab-span">	</span>.states_([empty])</p>
<p class="p12"><span class="Apple-tab-span">	</span>.action_({<span class="s4">|v|</span></p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>if((slots[<span class="s5">"slot"</span>++i].states[0][0]!=<span class="s5">""</span>)&amp;&amp;(winOpen==<span class="s4">false</span>)){</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>fxwin = <span class="s4">Window</span>(slots[<span class="s5">"slot"</span>++i].states[0][0], <span class="s4">Rect</span>(rrand(0,500),rrand(0,500),200,200)).front;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>fxwin.view.background_(<span class="s4">Color</span>.rand);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>fxwin.onClose_({winOpen=<span class="s4">false</span>});</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>winOpen = <span class="s4">true</span>}</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>{if(winOpen==<span class="s4">true</span>){fxwin.front}};</p>
<p class="p11"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span></p>
<p class="p12"><span class="Apple-tab-span">	</span>})</p>
<p class="p12"><span class="Apple-tab-span">	</span>.canReceiveDragHandler_({<span class="s4">View</span>.currentDrag.isString})</p>
<p class="p12"><span class="Apple-tab-span">	</span>.receiveDragHandler_({</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>insert.value(i, <span class="s4">View</span>.currentDrag);</p>
<p class="p12"><span class="Apple-tab-span">	</span>})</p>
<p class="p12"><span class="Apple-tab-span">	</span>.beginDragAction_({</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="s4">var</span> drag;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>drag = slots[<span class="s5">"slot"</span>++i].states[0][0];</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>slots[<span class="s5">"slot"</span>++i].value_(0).states_([empty]);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>remove.value(i, <span class="s4">View</span>.currentDrag);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>drag;</p>
<p class="p12"><span class="Apple-tab-span">	</span>})</p>
<p class="p12"><span class="Apple-tab-span">	</span>.keyDownAction_({ <span class="s4">arg</span> view,char,modifiers,unicode,keycode;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>switch (keycode)</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>{51} {slots[<span class="s5">"slot"</span>++i].value_(0).states_([empty]);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>slots[<span class="s5">"slot"</span>++i].refresh;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>remove.value(i, <span class="s4">View</span>.currentDrag);</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span><span class="Apple-tab-span">	</span>};</p>
<p class="p12"><span class="Apple-tab-span">	</span>});</p>
<p class="p11"><br></p>
<p class="p12">};</p>
<p class="p11"><span class="Apple-tab-span">	</span></p>
<p class="p12">f.nextLine;</p>
<p class="p11"><br></p>
<p class="p12">[<span class="s5">"a"</span>, <span class="s5">"b"</span>, <span class="s5">"c"</span>, <span class="s5">"d"</span>, <span class="s5">"e"</span>, <span class="s5">"f"</span>].do{<span class="s4">arg</span> item, i;</p>
<p class="p12"><span class="Apple-tab-span">	</span><span class="s4">Button</span>.new(w, 70@70)</p>
<p class="p12"><span class="Apple-tab-span">	</span>.states_([ [ item ] ])</p>
<p class="p12"><span class="Apple-tab-span">	</span>.action_({<span class="s4">|v|</span> })</p>
<p class="p12"><span class="Apple-tab-span">	</span>.beginDragAction_({item})</p>
<p class="p12">};</p>
<p class="p12">w.front;</p>
<p class="p12">)</p>
<p class="p16"><br></p>
</body>
</html>
